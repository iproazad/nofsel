<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>توليد الأيقونات - Misconduct Logger</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    .icon-preview {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    .icon-item {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 5px;
      text-align: center;
      width: 120px;
    }
    .icon-item img {
      max-width: 100%;
      height: auto;
    }
    .icon-size {
      margin-top: 5px;
      font-size: 12px;
      color: #666;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>توليد الأيقونات</h1>
      <p>أداة مساعدة للمطورين</p>
    </div>
  </header>

  <nav class="nav">
    <a href="index.html"><i class="fas fa-home"></i> الرئيسية</a>
    <a href="convert-to-apk.html"><i class="fas fa-mobile-alt"></i> تحويل إلى APK</a>
  </nav>

  <main class="container">
    <div class="form-container">
      <h2>توليد أيقونات التطبيق بأحجام مختلفة</h2>
      <p>هذه الأداة تساعدك على توليد أيقونات بأحجام مختلفة لاستخدامها في ملف manifest.json</p>
      
      <div class="form-group">
        <label for="icon-upload">تحميل صورة الأيقونة الأصلية (مربعة، يفضل 512×512):</label>
        <input type="file" id="icon-upload" accept="image/*" class="form-control">
      </div>
      
      <div class="text-center mt-3">
        <button id="generate-icons" class="btn btn-primary">
          <i class="fas fa-cogs"></i> توليد الأيقونات
        </button>
      </div>
      
      <div id="icon-preview" class="icon-preview"></div>
      
      <div id="manifest-code" class="mt-4" style="display: none;">
        <h3>كود الأيقونات لملف manifest.json</h3>
        <pre id="icons-json" class="code-block" style="direction: ltr; text-align: left;"></pre>
        <button id="copy-json" class="btn btn-secondary mt-2">
          <i class="fas fa-copy"></i> نسخ الكود
        </button>
      </div>
    </div>
  </main>

  <footer class="text-center mt-4">
    <div class="container">
      <p>&copy; 2024 تطبيق تسجيل المتهم والمشاكل</p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const iconUpload = document.getElementById('icon-upload');
      const generateBtn = document.getElementById('generate-icons');
      const iconPreview = document.getElementById('icon-preview');
      const manifestCode = document.getElementById('manifest-code');
      const iconsJson = document.getElementById('icons-json');
      const copyJson = document.getElementById('copy-json');
      
      // Icon sizes needed for PWA
      const iconSizes = [72, 96, 128, 144, 152, 192, 384, 512];
      
      generateBtn.addEventListener('click', function() {
        if (!iconUpload.files || !iconUpload.files[0]) {
          alert('الرجاء تحميل صورة أولاً');
          return;
        }
        
        const file = iconUpload.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
          const img = new Image();
          img.onload = function() {
            // Clear previous previews
            iconPreview.innerHTML = '';
            
            // Generate icons for each size
            const icons = [];
            iconSizes.forEach(size => {
              const canvas = document.createElement('canvas');
              const ctx = canvas.getContext('2d');
              canvas.width = size;
              canvas.height = size;
              
              // Draw image on canvas with proper scaling
              ctx.drawImage(img, 0, 0, size, size);
              
              // Get data URL
              const dataUrl = canvas.toDataURL('image/png');
              
              // Create preview item
              const iconItem = document.createElement('div');
              iconItem.className = 'icon-item';
              
              const iconImg = document.createElement('img');
              iconImg.src = dataUrl;
              iconImg.alt = `Icon ${size}x${size}`;
              
              const iconSize = document.createElement('div');
              iconSize.className = 'icon-size';
              iconSize.textContent = `${size}x${size}`;
              
              const downloadLink = document.createElement('a');
              downloadLink.href = dataUrl;
              downloadLink.download = `icon-${size}.png`;
              downloadLink.className = 'btn btn-sm btn-secondary mt-2';
              downloadLink.innerHTML = '<i class="fas fa-download"></i>';
              
              iconItem.appendChild(iconImg);
              iconItem.appendChild(iconSize);
              iconItem.appendChild(downloadLink);
              iconPreview.appendChild(iconItem);
              
              // Add to icons array for JSON
              icons.push({
                src: `icons/icon-${size}.png`,
                sizes: `${size}x${size}`,
                type: "image/png"
              });
            });
            
            // Generate JSON
            const iconsJsonText = JSON.stringify(icons, null, 2);
            iconsJson.textContent = iconsJsonText;
            manifestCode.style.display = 'block';
          };
          img.src = e.target.result;
        };
        
        reader.readAsDataURL(file);
      });
      
      // Copy JSON to clipboard
      copyJson.addEventListener('click', function() {
        const textArea = document.createElement('textarea');
        textArea.value = iconsJson.textContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        alert('تم نسخ الكود بنجاح!');
      });
    });
  </script>
</body>
</html>